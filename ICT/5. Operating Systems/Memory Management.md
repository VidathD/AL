 > Vidath Dissanayake | Sri Lanka
> Links: [Operating Systems](Operating%20Systems.md)

- Memory management is the functionality of an operating system which handles or manages primary memory, or physical memory, and moves processes back and forth between main memory and disk during execution.
- Memory management keeps track of each and every memory location, regardless whether it is allocated to some process or it is free. 
- It checks how much memory is to be allocated to processes. It decides which process will get memory at what time.  It tracks whenever some memory gets freed or unallocated, and correspondingly it updates the status.

An OS does the following activities for memory management.
1. Keeps track of primary memory. (What part of it are used by whom, what part are not used.)
2. In multiprogramming, the OS decides which process will get memory, when, and how much.
3. Allocates the memory when a process requests it to do so.
4. Deallocates the memory when a process no longer needs it or has been terminated.

# Memory Management Unit (MMU)

Hardware device that maps virtual to physical address.

MMU uses the following mechanisms to convert virtual address to physical address.
1. The value in the base register is added to every address generated by a user process, which is treated as offset at the time it is sent to memory.
    - If the base value is 10000, then an attempt by a user to access location address 100 will be dynamically reallocated to location 10100. 
    - The user program deals with virtual addresses; it never sees the real physical addresses.


# Virtual Memory and Main Memory

![Paging](assets/images/Paging.svg)

# Mapping

Connecting a frame compatible to an address in a page in the virtual memory is called mapping. The process of mapping takes place when the processes move from the main memory to the virtual memory.

The processes moved to the virtual memory have to be taken back to the main memory. For that, a track of the locations where each of the processes were saved has to be maintained.

# Page Table

The table that maintains information relevant to the exchange of data between main memory and page in virtual memory is called page table.

# Questions

1. Which device generates the logical address?
   - CPU

2. Which memory belongs to the logical address space?
   - Virtual memory.

3. What are the 2 parts of a logical address?
   - Offset, page number.

4. What are the 2 parts of a physical address?
   - Offset, frame number.

5. Where is the page table?
   - In the main memory.

6. What is the necessity of a page table?
   - All the processes which goes into the virtual memory need to create a page table.

7. What is in the page table?
   - Page number, frame number.

8. How does the CPU generate a page in virtual memory?
   - Using a logical address.

9. If the page number of virtual memory is 6 bits, then what is the number of pages there?
   - $2^{6} = 64$

10. What is the number of pages and offset, if the page number contains 8 bits in 32 byte addressable virtual memory.
    - No of total bits for page number and offset → $32$
    - No of bits for page number → $8$
    - No of pages → $2^{8}=256$
    - Offset bits → $32-8=24$
    - Offset size → $2^{24}$

11. What's the number of pages and page offset if the page size is 4 KB in 32 byte addressable virtual memory.
    - Offset → $2^{2} \times 2^{10} = 2^{12}$ bits
    - No of bits for page no → $32-12=20$
    - No of pages → $2^{20}$

12. In a certain computer, physical memory has a total capacity of 64 MB. Virtual memory address space is 4 GB and page size is 4 KB.
    1. What is the number of pages?
       - 4 GB → $2^{2} \times 2^{30} = 2^{32}$
       - Offset → $2^{2} \times 2^{10} = 2^{12}$
       - Total no of virtual memory bits → $32$
       - Offset bits → $12$
       - Page number bits → $32-12=20$
       - Number of pages → $2^{20}$
    2. What is the number of frames in the physical memory?
       - Total number of physical memory bits → 
    3. What is the capacity of the page table?
       - Capacity of page table = No. of pages $\times$ Frame No.
       - Capacity of page table = $2^{20} \times 14$

13. The physical memory has total capacity of 4 GB. The size of a memory frame is 4 KB. Compute the total number of frames in physical memory.
    - Total memory capacity → $2^{2} \times 2^{30} = 2^{32}$
    - Total memory capacity bits = $32$
    - Size of a memory frame → $2^{2} \times 2^{10} = 2^{12}$
    - Bits per frame = $12$
    - Number of frames = 